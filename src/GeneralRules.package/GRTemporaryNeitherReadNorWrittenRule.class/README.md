There is something wrong in the method as you have variables that are either nor read or not written (or both).